<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Image Mosiacing: CS194, Jingyi Li</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/3-col-portfolio.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Page Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Image Mosiacing (Pt 1)
                    <small>Jingyi Li, cs194-bx</small>
                </h1>
                <p>In this assignment, I calculated homographies of user-defined points to rectify images and blend multiple images together to create mosiacs! Then, in <a href="#partb">Part B</a>, I implemented adaptive non-maximal surpression on Harris corners to create MOPS descriptors, and, discriminating them with RANSAC, implemented automatic mosiacing. </p> 
                <br/>
            </div>
        </div>


        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Image rectification
                </h1>
                <p>After shooting some images (all from my Canon Rebel T3), we can recover its homography matrix with at least four user defined points. This matrix is a projective transformation, as opposed to the affine ones that needed 3 points we used in the face warping project. I shot some square things around my co-op, Cloyne, at an angle. For the coordinates of the final image, I assumed they were square; if they clearly weren't, I assumed they were just the edges of the image canvas.</p> <br/>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 portfolio-item">
                    <img class="img-responsive" src="img/palin.jpg" alt="">
                    <h3>Sarah Palin Mural</h3>
                    <p>This was taken with my Nexus 5 as fast testing.</P>
            </div>
            <div class="col-md-6 portfolio-item">
                    <img class="img-responsive" src="img/palin.png" alt="">
                    <h3>Rectified Palin</h3>
                    <p></P>
            </div>
        </div>
        
                <div class="row">
            <div class="col-md-6 portfolio-item">
                    <img class="img-responsive" src="img/cow.JPG" alt="">
                    <h3>Cow Mural</h3>
                    <p>My favorite one in Cloyne.</P>
            </div>
            <div class="col-md-6 portfolio-item">
                    <img class="img-responsive" src="img/cow.png" alt="">
                    <h3>Rectified Cow</h3>
                    <p></P>
            </div>
        </div>

                <div class="row">
            <div class="col-md-6 portfolio-item">
                    <img class="img-responsive" src="img/mural.jpg" alt="">
                    <h3>Steven Universe Mural</h3>
                    <p>Here's a meta move: rectification of an image that was formerly stitched using my phone's mosiac feature. (I painted this!)</P>
            </div>
            <div class="col-md-6 portfolio-item">
                    <img class="img-responsive" src="img/mural.png" alt="">
                    <h3>Rectified Mural</h3>
                    <p>Due to the cylindrical projection of my phone's mosiac feature, this result doesn't look that great.</P>
            </div>
        </div>

                <div class="row">
            <div class="col-md-6 portfolio-item">
                    <img class="img-responsive" src="img/cam.jpg" alt="">
                    <h3>Camera Obscura Photo</h3>
                    <p>Throwback to Proj 2.</P>
            </div>
            <div class="col-md-6 portfolio-item">
                    <img class="img-responsive" src="img/cam.png" alt="">
                    <h3>Rectified Soda wall / Jacobs' windows</h3>
                    <p></P>
            </div>
        </div>
     
       <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Image mosiacing
                </h1>
                <p>After we know rectification works, we can now create mosiacs! For my mosiacs of three images, I warped the left and right images to the center one. I used a forward warp to calculate the corners of the final canvas, and I did an inverse transform, like in Proj 5, to extract the pixel color values. Finally, I implemented linear blending to smooth the edges between each individual mosiac image using bwdist. </p> 
                <p>I will demonstrate the process with the dining area of our sweet Airbnb in Charlotte, NC. The majority of time this assignment was out, I was there for UIST. At least it made taking photos off Berkeley's campus easy. Below are the original 3 shots.</p><br/>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/a0.jpg" alt="">
                    
            </div>
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/a1.jpg" alt="">
                    
            </div>
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/a2.jpg" alt="">
        </div>
    </div>
        
                <div class="row">
            
                   <p>I then selected corresponding points by hand...</p>
            
            <div class="col-md-6 portfolio-item">
                    <img class="img-responsive" src="img/p1.png" alt="">
                    
            </div>
              <div class="col-md-6 portfolio-item">
                    <img class="img-responsive" src="img/p2.png" alt="">
                    
            </div>
        </div>

                <div class="row">
                    <p>Finally, inverse warping transforms and combines the three original images into a mosiac. With hard edges, however, you can see clear overlap between individual photos.</p>
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/hard.png" alt="">
            </div>
        
        </div>


                <div class="row">
                    <p>But with linear blending (technically feathering), the hard edges disappear. Sadly, this is not the best example: I think I both moved my camera, slightly, and also I didn't exactly shoot a "planar wall" (the hanging light post, for example, was pretty close to me and thus we see it kind of blurry.)</p>
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/bnb.png" alt="">
            </div>
        
        </div>

              <div class="row">
                <p>This mosiac of the Lib-Ed room of Cloyne is more successful, with the exception of some ghosting around the piano on the wall.</p>
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/c0.JPG" alt="">
                    
            </div>
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/c1.JPG" alt="">
                    
            </div>
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/c2.JPG" alt="">
        </div>
    </div>

     <div class="row">
                
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/cloyne.png" alt="">
            </div>
        
        </div>

    <div class="row">
                <p>Finally, here is a shot of Freedom Park in Charlotte, NC. There is a lot of ghosting on the branch, since it was harder for me to define points by hand on nature-like scenes. Hopefully, part 2 will fix this!</p>
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/b0.jpg" alt="">
                    
            </div>
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/b1.jpg" alt="">
                    
            </div>
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/b2.jpg" alt="">
        </div>
    </div>

     <div class="row">
                
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/branches.png" alt="">
            </div>
        
        </div>


<div class="row">
            <div class="col-lg-12">
                <h1 class="page-header"><a name="partb">Part B</a>: Harris Corners
                </h1>
                <p>Now we're going to work on automatically recovering homographies for image mosiacing! We shall be implementing MOPS - Multi-Scale Oriented Patches (MSOP, though?), as described in <a href="http://inst.eecs.berkeley.edu/~cs194-26/fa15/Papers/MOPS.pdf">this</a> paper. The first step is to use Harris corners to detect, well, the corners of an image.</p> <br/>
            </div>
        </div>    

<div class="row">
                
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/harris.png" alt="">
                    <p>All Harris points.</p>
            </div>
        
        </div>
<div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Adaptive Non-Maximal Suppression
                </h1>
                <p>As you can tell, there are <i>a lot</i> of Harris corners. What if we want to limit them 500 points? We could just get the strongest corners, but then they would be clustered around edges. With ANMS, we can choose strong but well spaced corners. We do this by calculating a minimal supression radius, the minimum distance of 1 point to another point with a higher corner strength, ordering all the radiuses, and taking the 500 largest radii. </p><br/>
            </div>
        </div>  
<div class="row">
                
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/anms.png" alt="">
                    <p>ANMS points.</p>
            </div>
        
        </div>

        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Feature Descriptors & Matching
                </h1>
                <p>Now that we have points, we put descriptors over them. First blur the image, then take a 40x40 box centered around a descriptor. We subsample this box every 5 pixels, for a final 8x8 descriptor. Finally, we normalize these descriptors to make them invariant to intensity changes.</p>
                <p>After we have descriptors, we use Lowe's technique to match them. The idea is pretty simple: we look at the two closest matches (by SSD) of a feature descriptor, and if the ratio of them is higher than a certain threshold (I used 0.4, per the paper figure), we keep the feature. This is because a good descriptor doesn't only have to be good, it has to be better than the next option or you don't use it at all.</p><br/>
            </div>
        </div>  


            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/match.png" alt=""><p>Matched points.</p>
            </div>
    

<div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">RANSAC
                </h1>
                <p>Finally, we can use RANdom SAmple Consensus to compute "inliers" to take the final homography. RANSAC chooses 4 out of all the matched points randomly, and computes a homography using them. It then applies this homography to the rest of the points, and the resultant points are inliers if their SSD is less than a certain epsilon--in this case, I used 10. Over 1,000 iterations, I chose the best homography (aka produced the most inliers), and used it to warp the entire image, as like in part A. </p><br/>
            </div>
        </div>  

     <div class="row">
                
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/cloyne.png" alt=""><p>Original hand-matched Cloyne</p>
            </div>
        
        </div>
     <div class="row">
                
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/autocloyne.png" alt=""><p>Automatically aligned Cloyne! Notice how there is basically no ghosting, because I apparently suck at picking points. Good thing Computer Vision doesn't.</p>
            </div>
        
        </div>

     <div class="row">
                
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/bnb.png" alt=""><p>Original hand-matched Airbnb</p>
            </div>
        
        </div>
     <div class="row">
                
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/autob.png" alt=""><p>Automatically aligned Airbnb! There is still ghosting on the lamp because it was really close to the camera and I suck at taking mosiac friendly photos, but the chair is much better.</p>
            </div>
        
        </div>

     <div class="row">
                
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/branches.png" alt=""><p>Original hand-matched Freedom Park</p>
            </div>
        
        </div>
     <div class="row">
                
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/autobranches.png" alt=""><p>Automatically aligned park in Charlotte! Notice how there is no ghosting on the branch. Fun fact: before I slightly downsampled the original images, I had ~32,000 Harris corners to run through ANMS (my bottleneck), which means the code would've taken 66h hours to finish. (With 5,000 corners it takes 2 minutes). </p>
            </div>
        
        </div>

    




       <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Bell & Whistle: Greening London
                </h1>
                <p>I found some photos from one of the many days I went to London when I studied abroad in Cambridge two summers ago. London has a lot of billboards/signs/adverts, but also a lot of parks. I put some green imagery on these billboards.</p> <br/>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 portfolio-item">
                    <img class="img-responsive" src="img/fleet.jpg" alt="">
                    <h3>Fleet Street</h3>
                    <p>Notice the half advert.</P>
            </div>
            <div class="col-md-6 portfolio-item">
                    <img class="img-responsive" src="img/garden.jpg" alt="">
                    <h3>Flower gardens in Regents' Park</h3>
                    <p></P>
            </div>
        </div>
        
                <div class="row">
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/sign.jpg" alt="">
                    <h3>Fleet Street Gardens?</h3>
                    <p></P>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/fashion.jpg" alt="">
                    <h3>Regent Street Fashion Show?</h3>
                    <p>But it would be cuter with a duck.</P>
            </div>
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/duck-orig.jpg" alt="">
                    <h3>Duck in Regents' Park</h3>
                    <p></P>
            </div>
              <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/duck-edited.jpg" alt="">
                    <h3>Duck edited</h3>
                    <p>In Photoshop so it looks more like a bad LCD screen.</P>
            </div>
        </div>
        
                <div class="row">
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/duck.jpg" alt="">
                    <h3>Pay attention to the duck!</h3>
                    <p></P>
            </div>
        </div>


       <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Bell & Whistle: Rotational Invariance
                </h1>
                <p>My descriptors are invariant to rotations, as you can tell from this mosiac of my sister's desk I constructed by attempting to rotate my camera between shots.</p> <br/>
            </div>
        </div>


    <div class="row">
                
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/d0.JPG" alt="">
                    
            </div>
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/d1.JPG" alt="">
                    
            </div>
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/d2.JPG" alt="">
        </div>
    </div>

     <div class="row">
                
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/sal.png" alt="">
            </div>
        
        </div>

       <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Bell & Whistle: Multi Perspective Panoramas
                </h1>
                <p>Inspired by the lecture in class, and since I'm home for Thanksgiving, I created my own multi perspective panorama/Hockney image of my kitten, Emmet. I stiched together 10 pictures; you can see the originals <a href="https://www.dropbox.com/sh/9rtzizikv42013k/AAD17Iga7JXZZbBb3UU_Zypca?dl=0">here</a>.</p> <br/>
            </div>
        </div>
     <div class="row">
                
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/emmet.png" alt="">
            </div>
        
        </div>

<div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Bell & Whistle: Data Driven Panoramas
                </h1>
                <p>Inspired by the data driven lectures, I mined Flickr for some photographs of Half Dome. The program managed to correctly detect and stich together three photographs from different times, to a cool effect.</p> <br/>
            </div>
        </div>


    <div class="row">
                
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/y0.jpg" alt="">
                    Original <a href="https://www.flickr.com/photos/kirklougheed/13158398965/sizes/l">here</a>
            </div>
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/y1.jpg" alt="">
                    Original <a href="https://www.flickr.com/photos/davetoussaint/16013457476/in/photolist-fr64yT-fF8pMW-obbkMw-qQTtx1-wRZsyX-qp4a1q-8X5TAr-eLYDWi-rpyjZL-2zrav8-mhuo9R-izKJoc-pjvRLV-hEp4dz-6cy318-8enV3P-eEWrs-5XSgc6-5cAGum-8AusNt-qaMVWo-aejNor-qz31x-e4BVuq-jrCNAJ-9vucn9-fAohDq-8QspyZ-aHRhz8-7d3Rbu-m3LezF-6i2gvj-9GtUUh-3EQv14-AGQXYS-6r3VNg-neZ4k9-9XTp3y-aFq14T-9Rtca6-pGXwS9-eKgrNi-ovJDqz-rJwwm-bW5zmt-e9EjZA-s43CUF-kZpeV8-vqiwHS-rSGDqZ">here</a>
            </div>
            <div class="col-md-4 portfolio-item">
                    <img class="img-responsive" src="img/y2.jpg" alt="">
                    Original <a href="https://www.flickr.com/photos/apurva_madia/9631783916/in/photolist-fr64yT-fF8pMW-obbkMw-qQTtx1-wRZsyX-qp4a1q-8X5TAr-eLYDWi-rpyjZL-2zrav8-mhuo9R-izKJoc-pjvRLV-hEp4dz-6cy318-8enV3P-eEWrs-5XSgc6-5cAGum-8AusNt-qaMVWo-aejNor-qz31x-e4BVuq-jrCNAJ-9vucn9-fAohDq-8QspyZ-aHRhz8-7d3Rbu-m3LezF-6i2gvj-9GtUUh-3EQv14-AGQXYS-6r3VNg-neZ4k9-9XTp3y-aFq14T-9Rtca6-pGXwS9-eKgrNi-ovJDqz-rJwwm-bW5zmt-e9EjZA-s43CUF-kZpeV8-vqiwHS-rSGDqZ">here</a>
        </div>
    </div>

     <div class="row">
                
            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/halfdome.png" alt="">
            <p>Time changing Half Dome.</p>
            </div>


            <div class="col-md-12 portfolio-item">
                    <img class="img-responsive" src="img/halfdome-c.png" alt="">
             <p>Cropped</p>
            </div>
           
        
        </div>


<div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Takeaways
                    
                </h1>
                <p>While I didn't think Part A was super cool, I enjoyed part B more, especially since automatically aligned mosiacs were so much better than my hand-defined mosiacs. It made me trust in computer vision, and realize that a lot of feature detection/matching things are just a bit of clever math.</p>
            </div>
        </div>



    </div>
    <!-- /.container -->

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

</body>

</html>
